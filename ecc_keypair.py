#!/usr/bin/env python3

import collections
import random
import hashlib


EllipticCurve = collections.namedtuple('EllipticCurve', 'name p a b g n h')

curve = EllipticCurve(
    'secp256k1',
    # Field characteristic.
    p=0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f,
    # Curve coefficients.
    a=0,
    b=7,
    # Base point.
    g=(0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798,0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8),
    # Subgroup order.
    n=0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141,
    # Subgroup cofactor.
    h=1,
)


# Modular arithmetic ##########################################################

def inverse_mod(k, p):
    """Returns the inverse of k modulo p.
    This function returns the only integer x such that (x * k) % p == 1.
    k must be non-zero and p must be a prime.
    """
    if k == 0:
        raise ZeroDivisionError('division by zero')

    if k < 0:
        # k ** -1 = p - (-k) ** -1  (mod p)
        return p - inverse_mod(-k, p)

    # Extended Euclidean algorithm.
    s, old_s = 0, 1
    t, old_t = 1, 0
    r, old_r = p, k

    while r != 0:
        quotient = old_r // r
        old_r, r = r, old_r - quotient * r
        old_s, s = s, old_s - quotient * s
        old_t, t = t, old_t - quotient * t

    gcd, x, y = old_r, old_s, old_t

    assert gcd == 1
    assert (k * x) % p == 1

    return x % p


# Functions that work on curve points #########################################

def is_on_curve(point):
    """Returns True if the given point lies on the elliptic curve."""
    if point is None:
        # None represents the point at infinity.
        return True

    x, y = point

    return (y * y - x * x * x - curve.a * x - curve.b) % curve.p == 0


def point_neg(point):
    """Returns -point."""
    assert is_on_curve(point)

    if point is None:
        # -0 = 0
        return None

    x, y = point
    result = (x, -y % curve.p)

    assert is_on_curve(result)

    return result


def point_add(point1, point2):
    """Returns the result of point1 + point2 according to the group law."""
    assert is_on_curve(point1)
    assert is_on_curve(point2)

    if point1 is None:
        # 0 + point2 = point2
        return point2
    if point2 is None:
        # point1 + 0 = point1
        return point1

    x1, y1 = point1
    x2, y2 = point2

    if x1 == x2 and y1 != y2:
        # point1 + (-point1) = 0
        return None

    if x1 == x2:
        # This is the case point1 == point2.
        m = (3 * x1 * x1 + curve.a) * inverse_mod(2 * y1, curve.p)
    else:
        # This is the case point1 != point2.
        m = (y1 - y2) * inverse_mod(x1 - x2, curve.p)

    x3 = m * m - x1 - x2
    y3 = y1 + m * (x3 - x1)
    result = (x3 % curve.p,
              -y3 % curve.p)

    assert is_on_curve(result)

    return result


def scalar_mult(k, point):
    """Returns k * point computed using the double and point_add algorithm."""
    assert is_on_curve(point)

    if k % curve.n == 0 or point is None:
        return None

    if k < 0:
        # k * point = -k * (-point)
        return scalar_mult(-k, point_neg(point))

    result = None
    addend = point

    while k:
        if k & 1:
            # Add.
            result = point_add(result, addend)

        # Double.
        addend = point_add(addend, addend)

        k >>= 1

    assert is_on_curve(result)

    return result


# Keypair generation  ################################################

def schnorr():
    
    private_key = random.randint(0,curve.n)

    public_key = scalar_mult(private_key,curve.g)

    print("  private key: ",hex(private_key))

    print("\n")

    print("  public key: ",hex(public_key[0]))

    print("\n")

    print(len(''.join(hex(private_key)))-2)

    print(len(''.join(hex(public_key[0])))-2)


    
    r = random.randint(0,curve.n)#nonce

    R = scalar_mult(r,curve.g)# R = rG

    h = hashlib.sha256() #hash

    m = "hello" #message

    h.update(m.encode())

    c = h.hexdigest()
    
    
    s = r + (int(c,16) * private_key) % curve.n # s = r + H(m) * private_key 

    print("signature is : ",hex(R[0]),hex(s))
    print(len(''.join(hex(R[0])))-2 + len(''.join(hex(s)))-2)


    Q = scalar_mult(s,curve.g) # sG

    P = scalar_mult(int(c,16),public_key) # H(m) * public_key
    
    if point_add(R,P) == Q: # sG 是否與 R + H(m) * public_key 相等

        print("signature is valid!")

    else:

        print("signature is invalid!")
     
def multi_schnorr(d):
    
    f = open("test_file.txt",r)
    R_list = test_file[4]
    #private_key_list =  [54452100212928332917080255120269160439334642169807103100448918577648878967928, 60676185293920060554877929197117334438629215827414548384185373728617802383762, 9725870487700854872942663226403215906026428257144567562766976393151522519916, 594787123721769110411761451204283376554292506952379793966277836736183743281, 30820298187401603277589991348868926786166740217868958689310783763083457668141, 95254299252943395091953848198869043883349456456729294581682068192388033510630, 7602265875773487398899447806898396529991531340499137658376359445894066960220, 44803534191419148555705043926816990949494317224583215506042806897393388868962, 43460371284131710403588318596026240471819650262357456848251023029090598957409, 3438147725550552923061594034947322891653233199509507584028776371995037757056, 73237368519050554365433828290758924074941656764918109956781664804049187311322, 113979046122010750669025278625047708235132211111078967625270214698288668819911, 42027790640686988058404204044499726485726000692212543676679202269086690576590, 50372955731461061118293809456347062770647539362247770702220061058068355702059, 94307117567808590088680051721475475006920395754075920741260746820324568480429, 50420107718206257076844568094752426524223772318881039885804336479119371176724, 89768895352254721765759504738980405009511219981234343948806570602793120657428, 92425811441747322175088612911201474830034212500428075088605793237342864427220, 109095497713269123854391861249353536662171375112055151161097864633727106108933, 59524187049646701863856385347199012224426746963042531587419713006516407373845, 76186739717327796416804700032545770865109712342015456270526776430703254158488, 27898805520192138782153205321369615686516946021804987821548227292270810870869, 61022684452885908258927915335605580917215698416665057447547121996304952316925, 71096115828702432410217774770443400461674656028329309948701015396425393469745, 97977162749409360286807751215321883666332552362055516421567526515256350483441, 7704312216606082010100889652261526106724188252283936614375224342726289262903, 38933562954940946093154103701382774810040500654705525663314223996822074672960, 21157035419249388105681536246354322449145763174175801610612577703127107785087, 86741444287494451877772322307004032673825140488455584750424996101256248663150, 66383562805680771390255863500466647562344623521569496317265218652229777882664, 90142349739565786038053417761141289511085351602206127189738284661260309706385, 21049739421914267870362452097401881775230794931049400093158133462731414157379, 76763644663326671755387458067136118922630428306208492232639397017272146560426, 47070274158838145574890327025295756051572792758258257735743388539111078778581, 57772882345849290526175912300781503240883540486583846473117512259405875612441, 47088349672367216091500278565925207448912699281639668339127111668526185079726, 75890833190058354614573748832283283754190080165610498626031968308621770855270, 52506324722042059872541466363125839659892427724542629450901666317165639747843, 3510702747156900636802965874255546546306026638302096279740898609323471045974, 39616727583126485942243089563397560659139130177379501880628199935448314413617, 99072200052596355637617428678275868355115917679679403015384870272120905944585, 107378997793717283641163010163241713809546576070655213862885375046078117370532, 64547404671551077988824189579993557520561283354339711304787460636937388866714, 27601833014245514071200974009147894894081443742233406930229289939690380399888, 65131523216404936977660405963792878275041671598612243641601776555471810633676, 1836857490785485651390344400079192144552721645763632934069153200678105664928, 74161011722336767663757566733525665850736261049107706632124390414968178199967, 22113650267160889470461172552074173316406712579031556016607069929531802433096, 10775512131735279951774253787749305737920038626732551531635380930057988258699, 9978853789408166766287470812906941743665147544302431048318022111957220821248, 66958036913553475818656447496227293065450536413343313300733514702382488335941, 31868937125043321324709188837699716945327203048930380044817773156271953577523, 58265998361837303896667327654070800825131075323717880164435988733272866985846, 36815326061868754741133867581210112936086970843368783092783156884413477265173, 84361994921568870008486809515634691831367423686955329988692242151900303868789, 88296976697599474004638259113839344230493906546271963983427161291708251619, 7396087558211744206614700470285401413653370267177580501422363113058267150445, 105194581472387338217651998056130128216496548907567138096743605701032895487125, 8576040014878546892489519503474824325599684779962478203002229607912447033965, 49706734168874972699472688450089060948786390728012714644895977963505043994716, 54994246166605098169915726026622303830791534696385175466308288699559263549319, 25265403824790246319932508049574604298178966576637442938186990423728113856325, 82179590402380326132360766932823625800710420284119358375902101604087757314546, 76951382692914987472982914639640177644742228146785873087189510931432241232212, 64313154377918467440509086395322590978384574140835608419064605034018509134318, 94981440337460885179604503248536302622365190981401667680858260359675570521437, 105580856068191400761082782175924499401673603032821411875941526538566830007279, 27616259115892190799164095446958563434999867741812940551207360407470349883674, 49763722221541455433591028926857327515326751570187870796103676281292766023869, 46688751325545387001618777042488844874058836582594240303420261611043379113915, 100217424038888207675412882068683275087026335649099978123475054930514379793362, 81748457656373953315462353047950416009169327028903861851220337741006242540967, 58674022410980193851609988757259581594803309744252840928765643525241151539192, 70671550967156790810630259179105696048179239798102248196466454595196580068962, 46229509633442921126225470329915700635115209271815930897939342525455538002197, 37842614023596518014542698660247479226742195587868572828000547433320560090629, 27032281290873042429985186845157035235770611061756146768977655361194861743507, 50742817885534555829428087685140331003502536564826167286646247255545692957712, 8392808878315650421678822868785200039436591731627066284550567800846083535077, 78037260729712109251055518706483964577337634665633416977458060920411316971754, 63350580213318055682968009968728313857325610819854783042702751651301952570724, 31017586558494347514290629433307014079500757893073632072795620439699551110738, 47896948616602822126079863144215032409051343910446766658682454165960763927288, 94777937739659351514287100182065455575516168582241469437198861043721227086463, 38485127338057056469678697524782062149637624131800925332826052932819679187824, 7660187545260128811256818824469303150845065545921034915477572407440103390871, 29519369825990928074142247278110982506710399512645995068066607602556984540274, 8711920693102023747273883986173267248486646253724211608440980376300690288382, 75849551113594190352132959094760230500846839653400412786787972085048607515790, 16988222559385094967279272669758121395006805919241099917884306274212077298154, 19609635826902971892318840161016345446410184292210719688283616886342782713183, 107311006924653974662034320372469000347542745272247714842390024774151299003188, 13074966221409425879317537737956924177852999769440104362832908768980810509798, 109975103751743247103849552455304712922529109921538354898693545691726985904310, 72385393945024616872931984009878597243755052087744058848087520736966489906210, 49258515258281842137656437303097013762849677476469347750600449979651351798571, 70575188087590403740777630500262081087527584073099528929037880014498232495840, 5170717433371940555324588741256939177329525144616538463578317747317555543662, 64365758106205435227428934439994943872698461496222414354147318674546913974715, 90938076644386158720658471938825714626833573645430246086419787215712823776016]
    #public_key_list = [(102325843645188074252211387972892124951691783516001666961558737567194836799164, 14184321451480898437868708355377555617078644771093265974605469493290362728608), (60232604767001139235743482653496898679726015442189847482947302430126851701606, 74656518977970210951777125416601462153392801111974926747144729873918016270461), (39691311456179304481647811009653409801428959911221836242914666651057026287581, 93660118019418406781124261634770925598818486251204672437473921395947434783675), (25469748460246684210440856388080219742721878223321505727712567813521311127887, 69377858027501221421458445250662866344893647614547977650469625964614068898040), (61923153241732103752251483550237147903215610791955509770737989156587323510935, 12238950791684373796365725368915497342143999700510444011886024004218586942212), (37788833487663156935315644702122501570983124768194812462493530059071143840363, 41845303445080942046055124864952847450743468080204828164828858780125282291943), (113919089349243220189369191549040707479613565405773205115579313383993599189841, 93325866861102131657534057022037009391246746052870029730822457057440575447739), (12838650366345480044789420699329471667029852241648973569409962813053630025978, 58272909219781312724874975510790756043542637903828312304157672729608687033238), (50846236409426689391807589110905256786147710858554120227791105822051174859968, 59098083099585175457278461713093623694864990346668332481782106460412370531337), (88410826728169034935355922436449300114594752409782756391495590873928839919638, 72643798916523234864766859421971700062594118448647574249586947270249073961545), (56580012559054847008017605475217171455227186852563889411027700089666315278645, 72252061833970870225470370973028712793242056502386306692292046212593167573153), (99334092548693160334154969325557385563743513591922183158351575181845100344859, 84534195410409461199701311045047298908803773031331621594394440680237844047208), (73690867600668198491220570550817006850118719942489513203648001871076875847454, 6193721716324929380981059745208253591038219245104709431231793195185976001999), (13216131406752090295034603960052266322198459567028062527726377465300754680884, 100689585723966987527100911774387269896223033347599316467925785719472904582023), (12788876175369740370004099933226333942973974528092718265744412582524536382244, 13243677530372537731397612370069991645047932334816412106240996393690628927223), (63105111266954728942614485110639547373363713241370248430825131440409593359093, 102896790850755545146504950615778981919377877039923439113832390544579384870591), (40644751074206863076540223642937239995976696403984938055764144360769034283014, 10079310407625716736860471993619204835323575447845336864203193922977144211226), (50780262690389188160589083573277178111937739628619863799275809484421498927592, 25770791684831957158986112411156524957675532625044799615278219051789132208497), (86471937512631408211300873344781066503672446199562227561720762408347150925913, 97325425785090404294384863826020296505877249284197809992053071158889114897862), (23370136133213998975233408056854470143176140138752848888957289624231756812143, 50397470035029068876554955351910143060005763130938328013961070327599342351391), (74361300320703018145631126723980260226943802221622175562633906544883309169479, 104873346005021813917975000441488231179645883776351527863770245057878952717599), (94938918638851945960846282382381612300541259128514623451970559834729468992337, 69688791032273248255049610774753719538014216424827520403149654139719481135861), (33773266394031542476079938451453021810973731010252652490583471549635231680830, 69431998133553896835406775865468160912059279908215724899842368606249531734076), (45766298731479440523824955465565518652771147847301905615173923003163984828701, 45073159832673001030163976172377677253043978496055497286608362478940521893987), (111362921897712429591145902497316577263333995341874610626820256689305038535230, 38241835427146257139272126493581572260420598936608205129541132943342990629194), (109524210945922626650589437919453429556694778085142351526772872067281265799623, 31167935084245592489902829604315889432470042024937741957975836281423509431951), (87095924470621076122163705253430319257792110586704620145800635122880320335977, 61659918498895329998888191097832325217561166964969291454820830281668260386547), (78554479503167887698005737231020464464073897202202405074159128891403297407439, 107084025717577115807435828155019373660936397025705861172127263035597266725559), (5333828059280715527516722943873060439575790109640440198877492770714506701926, 98176997794840874323749473542221636099273868288665034568241494441233010605730), (54608322221790744467758577862443098354003272544199825272163243621477763060834, 29361040566533184331616174172022687472348510628481841379192899095585628775444), (15724101645380977910459548321763723310219520728187354946347231569151665076007, 74655497604938212772985075256727752911438170395757287572130942187904518088355), (62520464785801750755566772527505803153032942166236809427993994166337844814300, 14175284158120954884125013864521014806368719277655114519036333189988184391304), (56684257792043476456354212148107099006311571911926521720873184439003010349748, 102086933321308603685751982650414630887201016749462977145205486088623568475166), (42293801344325588631643650750157957287094797682189665734456847125548066239925, 54600700288603467734753957552310125914760194946012160066915309516124698749100), (87734335918448280577976606226048550588348317642351617218074965077583218580078, 94897247422719975607761878189079743346828062039054819468106872484308888263796), (63764311241204307530682988285776182928743712740830601874510676187693386474332, 87951557969009251738459623489834021477674758516629525644575384976061094068887), (50244105716107569151548466763719050144247009393457661275736314978282316510308, 12866091753297970466086021188817518004475418794626458299355893543789881320735), (9956450913068791712601198466826382335853811805601408026199137487573734233650, 48073752824680717209446086813684784718275464437510646609218312480297763226862), (114500840898856065479305033655074519580916423744337950615359782970755627768958, 110554164957098357578179968433738675730697440722086924465046604360805990721988), (2104967168546754410738243337015740439732170972798325954690731486116672092140, 22567460484591095882733973533094399292004633706338489165980085024620713286989), (94783805798521627550934452221656408195729309978391171917139546565275489194157, 111567352874952827442371382077650673174409193390638014558687353133500467420592), (39540763332564771482876221675280609774385954787856870108842609876256770042613, 34623846858973938246068829203788467460491869715700523263618922429952925979088), (45717681584837164900322101426580153699745478743410372784162927785664498432226, 14020291559722574809804083928150958499243766557031230019818404057764334423034), (82265093620889112939662573778382382163537899811306158627638289158430060959864, 37321306949022470465771537698830488558870810654911077697570086346543972905177), (25174878237645997545985791208142245152216523116895811517255335407729885948398, 6632032507452014219481754334962939413313164968581515601085332177699201495721), (91683526720915793126170117697255498084877307985260986651075273126814326593226, 55138603819680176519531666601457149215524650058195640839081796446167333939158), (87696895173021709770533223020942486577224792324020726549589777522267574234811, 81762234709719207773089272176890418901105123831245154986318169307424053081400), (50477844254656249743909356739721157380144579988370495932294101726976394254559, 12691344361959001888788024245725321335652584832878942751736257476054574508907), (47673132338988014108971459220405208152210522085363876885199746500982548630636, 60775453217542303632009253984138769934382047267777728436172653448063118392343), (4267280005843905527187345964737455273571115844058692035444363860699830211629, 57990823538412614267957946115964554618335578442972224697283439811530264444003), (27808842197320119047668810794310721917220113022485982244022764515931983522509, 24549145750072312298115807947944461698664228990322176154975666166773535455748), (106532135288094063861709613568402541366394624976243361402502228802015494661204, 9289471398369033046031622723954444764151212532691350927332521586809046202478), (91488062748662280270832118255108676483221745392980483404336587336203991089116, 19982284369193613424307837461282905362399508331474985999534560646294253966445), (64282594880640705554080826634602777638872168120545976030436284416219611502539, 5763744340445535043390995396711732374879926855017885390362338165975497762977), (174664635267685046916391390109460703909610568285784383056725781577581605863, 107580577498145706194511466105257512983997412605590571768332188308256375877815), (96357332781905929834584365487774619297972308792217147029009348864542754327821, 92453229110880257627000018628053616514500554436221425998292244682729433224280), (39470120766586003809288810214329156334118304525961761744193583439537796255070, 42881708664073513419776149189502091524535668069128645966127663087247450407479), (83448190346126006593098156633699788195251480389848669867030532288799780590847, 89038878505708860320004581690507975413749589278402449070760141872200311500752), (44259728081594203026551519963945421507492201669192106450335635985130698418736, 95183819391301892423711341249340319134981185917770834759518068378129866322757), (88726304108603139901570641541628029666374121250925392833251735935049437374840, 17565634898225605616216339353260871411240965907593071676206172511905643390563), (74330677891167326276131821924321150709467469992601093739457215064634012554595, 97333521063521542259406938948245313995862595662936658597443076924467388471325), (17768059979057356226817350284734858885327288331292942453161447474958079504075, 5286927657837153456186197732581959221121841780767290275432911450405765077254), (11799476032977513428826634677350965411628823395407188664525632998648293561781, 92397320072504508055822751883386183826125077236241400217522572353938494274360), (21756019543374701092549897991112325673451744627170555366754687881753987428409, 9181629788138049278867445613886357299758397908675619616339196601317865583392), (44221989297138696287031224508877884607450453021734091398827323742941130381955, 58416580136359774649533604694270568158317726044535266984199418952478147879174), (33493894393408798977951343429110609397847812525503182645396976144217157348525, 80570162881330931454124260084775851240787232173033682873653062709216392047389), (35024859559589323317485698056498255634094387564678138490670215724655026289842, 30521761694783998784683638245437577408433823010193412430331125531358767405502), (38388113287748018643483932186036409776493802019825597819274372354820434829172, 36783526950120737938082319395181319342279314949089376149834493901057857359581), (82457674572144712146505746553250273580256592977240837846557933314680129350222, 6462335381350405080665593584448693616252268071133245388397103023531970605061), (46597526021250580799101569175694959186143475444384859580502561612967036922508, 23393576439775384081722052228671197645385396435580467808057509932189586199911), (88008730421203394300621324822605796853009021894272071797029586826707180555991, 102574159597432379300919923972870250069870921273578098764625730972895723489187), (27332846381991890524664037614955702854205285609334477378894843380178986762491, 19127272054299462781166667520944658653478943481956896099550967995005161563452), (81650024113634332359529051634659960317970729926333083626273934788082163291708, 94364415917798845132436688641847260401304659351212141413124546482358371628476), (86612614783458745236203431201324653843129057340225884574937151086274260248550, 89875892542345323924152755873587758771045330394971123874688119805898040175985), (104159441618480158595791070822627335680607503407269026673625619902027787523795, 106490482305430752835694083682992258347867374002166676954909574117264788566464), (43188427154932418397419408901669118787363680196138512993560797378600976666047, 88582336217059154187500861222651730670032468323342913710112810936052583606544), (74023597334431573103742569370668865638374268030964215477512781745724942196598, 95502129805516609228838184568719617313338593854734175011268017432682017886560), (10349555134830191189145910604647734596580302350487592325766963190625852363602, 42375032722899151130761197797766483460562205848694191735398638161047989968596), (52741076102365838156494986225234070116862537463912126862350007147134469534546, 78517147694744499199531963723494355146679272471895875385701240210923567082713), (33880420053181092129479286592928259363343749979290972752960212636111624559481, 11507467364900197507712586454229840470141432082990836400976779462951365448706), (102399099862183970923003711595743249901098643298881526771786534516152235987055, 28904892225516787914527309139631721667264731764198345509981324684505573128009), (78497371409235262012924956888110006921724320723692226541979062392138317794030, 5663985195325293847745623077842005935718838730426311429373047167684521754150), (13630753859069190531226171493304062744152997508934232771117562443144753034243, 64341614264373001520430617276228234930505248924475688376398233189291193693081), (80708420725206468824355988015392446707551817863286006385386617282112388197549, 57454644153210228796766194758901393130043375179282461882456073513924104688671), (60477143358288875024290335498960243117257749925959000162710868064091716787690, 63939654258829080431599597859432098905494527457489976437472162139298053464749), (91890566363649839937397272263376736829052276080244126734190824178285024536923, 65148520026084150819144869504572654990034173450886227623702773111103539667374), (35731249406922922894777128058352874816541263268761427344858039786035006551673, 66247084036235061487009454695095218816584146341129774721250615821739493102113), (34906603640291130607534873206666413619792017295174750149229996871880383454384, 66588371996102468710259451235607219065516111154869147826149731734058471839880), (58144597904384814076350776966316834853769807332549729250051923153665418150881, 32286913752724492751144080243880550608062359186522404230827684606975957491775), (4207776106655976275868607259618758804778094781943318968654603406088641940158, 99979126376510308803888652315627700409581734009536605178480632327577285947496), (40745252263329368391460886125076627801148195440792404538513590244568433637849, 26793120396019834633580317723504875805945830366175005289420972889085208041131), (416343971739783786283294085156035617412781802697713177909909614109318864308, 52457955376263461304610685337881495822926810533988331640420090358498674127034), (40345929327113447307937036428873044884386225729094454843229311175795134918610, 99449644295252637314417650223104387231212510372721647632241670610718680241142), (86307619850787570056889990502487972784485412258373162450927810699938732715050, 67903700447780962450490310887404094210476513660850740812580634082452219154535), (40502050770274157755632374383896506415674882138432717259645814826636378718523, 67865994669109913981945381452528055644714008682679675997086571952855871926157), (76564876910540158189092626136610245085468814054683625236102936055193914931334, 115157051476984150055952585505100128516609354854463956446783911163352168374237), (76469451051584795161785895799941951218191771685467555801757368738021340787804, 85567272628030144429577558516912763434976938887712423832925040587056992999839), (81476791883205363422349141666036748354219191674596133170473931354660572946827, 55781202489910401356838440273661757763037090410601668812505291770699923512548), (107352632608576630830657984320703598459121482233101785725894781158863357122351, 114185049083088469182291122549627016691594701139410480548906124395830878685399), (89549671111419381588184442901481680286282469738679894329980785399173573161301, 57820875535226058702721714934336250934768274008826756698387534828962622994985)]

    public_key_sum_list = list()


    R_sum_list = list()

    #r_list =  [77857595242498805228782128471652345004355457008897387059299428063149702384443, 46192373259558226389323245000717898883897814183838212244697434081807151816806, 80259196931789069678526372485594750759810119468691036401818523453929027688453, 1179503106726879087140432715804928482003968162915823434111924387568137699658, 91433167216207813457787210476381858385156832044568643314838046103612187493284, 93055016140299984170092134252696426052627095000624032672680285512134305854734, 85909164813112835131919878682850798538558879457083095403667274284103310865554, 70477240564372823975900202006062312983523833689037756510233068786855833720969, 27887823624924733501753940198156711256622197330755210801526006973239053297268, 28021433885546071569568538484813889787625900244496019590605928641272434716745, 69809747006726577697686264349545106855493488025961221091565238583205321888769, 75136005213443343271131610330804103013823449921498741500491343329197760700858, 102169193905990260186523521646269339329840383711154418885639115052680866118398, 92750939040759342901838045851168941626190875272251540453791247096283166629825, 57034336444712783039248386257504076776975868267686918270115930577837586010142, 78861684439132472498439764941593129422964550063045739912755669591708369835102, 110491539433729467281393718665078954957123362375883578917657435147040328029905, 72840045685346880235498118071007124027200425517067819042842211861658197552133, 16927077257003413210905082698213492157197739201280413481056008135582019531647, 2624250340446979603543554401885620450233493440542843140509073041048558794232, 68109201023543142987646181763241991952103601910755358972468909047524622814605, 35721074343330009783682005097442820821021518476845175857952732625689617661027, 45990590728144978652268714138860807239437005864420770423257657480910479312064, 15933428451079372136539168818866073943162049978468880499967090540820168470212, 39515029842437117515305464644830062610301961724696561227308570951886247974787, 23593935933503160976259530322711751434236998883106948509617983879282764539001, 72552699836915316646583120154413670127934628305365914863641173420752907831391, 105098392929449152122998548628100195998861435368594999484357048878736096513564, 96349388331599276450656645203975363505086506520794769196450045935232462330669, 100875106846904044690186412044366997351782350329601348274476080941156732055960, 107764822702250878724167770857733441070689548301585470609196097351226796496948, 82449066182606527332758884445594725758929964278307624590440112752273441776422, 1932428931479437663730286108645852646974425669733234643030045465075834400576, 16862132401831314974007724631063703882317761406451583967341565910395965994280, 79973655423650735335691278179122856131848329355252598073399566851351309367382, 110345469988273669150558841017306276088889521193943097563982698700948777532201, 107449826069068706489166746611295155748922347853989403780568469599135069491004, 2267949481167891369826954387610207409601534486984833889602129706019206213218, 33063702423833196605898713327615562709877085733856044064216278482242621780878, 9276200587963826731979808266860254809828377125805822879148531116517184221539, 741311594284626011580967649681812933145501931670350410629562165582023007677, 52560045638943947990295168230786157261623159036822409348372711444111467149980, 70131854881986284195671844561177187248475397612116698559372260020991507921746, 3834428931302682502028618813623117373632713026703353394440772115693489767428, 87739748966935948052944637062477356029992627038984490041119265912610644545976, 84955527695236433295985739506740076930543225580026884177994722686716946296769, 42552900171390307222604317108824030648420953995107562195900810952647787825730, 88805502036021822538241360172803631078606323064150457464093405576730773047686, 108011261410945821363784925533151120780093762646037119531419777347057567554962, 111050966080943679287811569851248565727708509531631673998951750446002118412143, 78909128196521231103023759764302311416668187140814428504865298457890140389961, 58748120501669422116094546398995388798260086431754294986782891612694207149694, 12050830361974999403031011955146034078896764316096052469139259118090890659837, 41805014132505373875796528904903686921029780833117244495386360228097476395680, 4797374962790110324783778533273270770622928817282226158880316036965994185248, 69554344356515365372929999279799806178683806724293964187725894329387112801080, 70393733812595524896305694905929933707419334277727971932588125999059882667808, 37306682365483216374589102963295207068780744189276861185292266277810074219740, 54497354909546201725149387297697020340475599830898257103174283865761480061428, 112024188577827929632580794395566026475759536773045154838722010948972836761347, 60828411119617253095523620341190760351585054636278868277871264310052752699208, 64481018670610415392168001357344763784843196736083080134430303173968153514550, 80417727571096301196079857150324619792229868946330071284516710281564301544291, 69169230370834227379386532168455819101100147780604969670317737434384640097842, 45417543406335058723574233348901020023031621064267009528999274452816139413896, 82503980597648571467193449743655939836087714716722143126700100378406127949229, 86988754855012722654609931085369735321114827629095857388198443825197053269385, 36633245554553598320354615038396339258648303316560966234426917987398358177915, 35680438345558337013346173177827601929339356121033477447119048553089546586560, 111599823407132171424885142757738787809504252541875628808296542822171257406971, 83627043645306188345331213774962852531057806749764320476799179436008801789906, 76187182001352200911678831051419136492054662833068217942276043579047250277737, 36063117024686631534207883466955924980655372896208799033546964180872728613792, 43502621764628066309627404216496156220960580897027775520903047637990256291574, 24249569389228474053832125103035040624151710511222555393869707012663424308340, 113367660058024614293701935676901181442742408361884812529049527415857905478470, 6302588005437989284426738400748849946545064442482586943200689688449799681818, 74603535851668118862740960726131559272668251123273294899292288215130699389687, 102954387228652437135007513919458147573184053373597944232895325802494619123599, 36216976842452107785987684268001004448223427996654984046600051097787836673539, 101214859513692226616304007887895244681678679785258807841947522508134276312264, 45012662850713492135384484663118132176691661862792165229472310584596869882555, 27006173095666035599985843443604373519960804509651112408977802066010169416537, 85891815538842281336257244125120072212550192316617809759044466579295090359947, 49362304567858152056310822139834285997779353208271211492875180759204497748723, 54326172158383043515726302583254059179619937799009125376238380492684451442933, 5469324760188201986098427544459315227871092020877945535894105495952009020727, 39695282108151922135050991756454150252079310066830597305348950517273345053455, 37974915225401840802495066144778988450492631505751982532346882414069891858163, 13434846062809584702748109068561196824094954808744002301141541824459662617640, 108076964397676675087591624893334296319778492671568375446125005595634155339078, 113215304282816577913890012173568451767741953554504672500631607206753121311800, 63436871877963136508407980464871327040011249160105785630715543687942381879021, 113536153405841351019186929944247489839851978932698921392950041516470640787926, 75525851925281943837898776304178965490429798332098797808305344627862637385233, 32908678768653393162144201012868379144393446646724494883381280832782005131295, 62955821380524136418744264374968143519314256814765166672377905504935440826628, 23514442430982382841773847530292495785720172945768245782112282569334176291693, 100771674141887514476082558401267243137946392127719938274673209549205988218559, 111824444989466209798652524362560921805520804844145566955317691224513232630387]

    #R_list =  [(67274065105690470909278827709288437220824223704336111173688614835917070379458, 49658349455755047006191921512075401847938100348914188537818001894519838571691), (37664893851114782108523100551149489580105834354106315716332742220911431929547, 10130688330065989787861567029136561806442897735203556040479656921810468559045), (102699769545239996642236763753725867379061666866777901164683573086743079324443, 42039339180973028536865054682236282720601872391425157555269651137456627107226), (17256631446677878532920556775233537058293850781816724112549836245621904806287, 249574984379283294597723630297297441175722895239724743393475701854040285415), (34164560053483003273702431761267846328082968953348623619748610076714275064183, 63171099707644603798980542221993583342606721294681794105695479109323320286231), (105664186602160574591907303900831199340812158701091886138794530023452152061579, 46727979746047695263935798634296653726950224540482020080847905444906230413291), (46904818221384253255291973280822117411615041363536142289294466189619926889986, 48866561418591547284597359513101279984392345621863930945335981022660145366426), (12791326795895342766791562536401624994544484413118129928274846015673670137313, 12869314613292089950249262353561275282585738943157847950824548141837131591867), (47679119690164825056842653879915862598362804097368191874275167455821487090822, 108353242384506465496477734304862269355243768744906477646457560514587688341124), (78604831687668033046319853573367402338364441550944923820424297841080639323869, 60877454745855460302775482150389307698366651865689421452163039856662024212775), (111777326950555016175503743725915628917179194032540071582388053997793590528921, 67342305162665595989577634008542859189262614555884089398455391912299738194515), (79601145460385453787918340596937497887687718084234518124700282715514946587333, 97346714116721166686357378076550795987439941253488727517384346738504329085566), (110331853255255201737675926941296895985136458408421249851199323066369437025756, 42610366937695140537607950548171240141417758588804717133947367954750402517915), (87368519784854592933853925162832792160466005647971181646771120801022301428949, 17553820226663748421489549838390961019264512254158095604205814879531493002895), (81642857091909191103129443072904860990001152676083582808762054746463278390154, 5778461880729948205978413427300949099716501152208445338946990517648493097924), (12943518929450110921538931116767150552878059227278093644375413318273249261903, 113885486892202240414905450753843508875319981662145157881388150520409018582086), (81545099948605575920386711692843197968157558944737342683163327846745377867367, 15706113541770782888143779234529751141155130215418569290353629363122133499752), (91220960751948687331437626222180174041601416429343091304907476911070205241939, 29847298295960867700292587255367105911987187562442248817979041562839626251824), (114913076978203067955300265048829185373879584189230393117666097217280059158402, 42779258167161084826851729359472822443907171506007503288191143146023305459764), (80081482614830413174668628879535221455207041221871070119414433168443582713693, 34614877420673673636094453274819949542498787573283478472320438741526879743050), (45430586521444958338180305429774187883448219966592126241452478412147676748159, 38672440238418269170110854400306880805433694152641874832920521894792390773757), (36402490603798308524020986807293090621951493085080398875684199106693153541529, 112625693463667703964939577146268951491394628554170943315432640616581871006363), (45268890930065982936321513142566333486306231565816108895146441353999137726838, 63526372584130965199383803903773722357737547363575270851668899764651319013663), (5359458356371643124907725842475711949136870765518884112122600772906479808650, 92552948150545132483286433336060751806045237996709421302102604815980089659586), (102065835142821247034665852710404839653275606452648597807125409188287695848864, 94293240683465777933220195609752747994523408590863340434046594283407549375454), (30840495344085514709617079603661816806986037015140938158308939702422281243351, 63209412171146501068741784427035544342348923357037247266668459527385663197468), (77281695550091333628876399394058688717912284831759802120924431831865922888969, 54265539633405850103440529095149811632700860644651467556629624075922283153525), (63367053603707331536769579357079572487396221353675777433297287280626487995793, 64972112983152205963935740041181860048176843270225219221948100294327227962381), (17739015126826823645255500592357304982012335556494454749402203265387604570686, 59121938563245842978108513307406432949718581866042084623218671291602537519362), (95639002948624555500825639316355251788423984109827007086360780305216573907604, 43750609528665860891550411667374419022301533697358362265448501043285253097592), (22278535627520573383273240281303630209183295582790783161724153706794945396330, 107613453610491533586858753520845631596074518478367254910209345457442355170723), (104844791166506412523213430049263181677130367663029411488921647266941650977615, 84423145979358134251385042955824403200770472504510252089185939971355760972439), (71240040842352368727343521900283205184186466619497802030365608730825673331187, 63175869309634038992148119705870399770018232820119886072377017717547355038499), (16028611567679107459313938711201125228555346447599070416793211812269213848951, 18286450986101085173558049882748610045484012475162277151239542350615426465841), (2740710996020654244371187871759880255103070422752274087041447261874281377365, 1858657406148108707053740190221942736854992546287716282217045629852328521510), (77239737806399167008405917196030935116848502265231546778034083553278452965585, 107971371700582157807501135039049111834949171047272081881500015504854427947606), (54509286507025163239449305698612332865832768674280044827111646644078022510844, 36563804814433681911327352583799850731359298896432230892162910620927715460873), (45594069305663921255364855715462956692226040143452307949362180560161196557104, 13543645891255182533951174481276230006995991426198614446577380967285328745059), (63046382147109877325690312550713329336807111405010442813140869630603787789122, 98035626505136035997027432197525556562061836918662844859134945716667020632039), (65225241780507178407866486329098662380890425671884946430647994140065993696795, 104308981252257487586916723121416270665685643994582257029682054386626577185691), (12841740197244241947913105709675054281896954593315002163464389576297919405695, 46703138679256112070736302646056377638007216180032210852587882796626966940971), (57034371124561750760921795434589244328614724893816429483160544076961655845283, 6978361530794426228019146532818463447218548413177120880616876403545538033257), (89655537061001878750590055332511625019944952817142632033881045846846375713455, 24039647575469175004984252585424316221704574300475908405062643126257780688540), (86541220427824996474352520947039974397488590171199787197161234239858557894205, 13708829243233702855540761322991136107853737114439754360139351800380817890723), (48090748555767326783076138724546467521662167276732394370240950919763691238620, 53331516394359633622033960511857280095562321291151924781573519459702660271825), (25293327710455243791214233586548740082888158485844306077556726233246457796246, 60391918520955595390531261591685808960835268293812633055168257435249150922755), (24313715081947171159408160409093095002470065317170421442069716874969733123426, 39925352060422135889206312893550014245919710291234622032656821048196481695896), (41024911114725639295654891260223594043899680932925300348626764147521298828690, 30368905017464556543976471197457869481191724877946702541256126420099467520568), (83858704275781309411744571203097256033251524047198028079325172623237035767070, 66819597474124499765506993016500718526324594637489538658712902561839019771444), (72774788863131421393790039778913579255797928609602160368499124992574478364540, 39428338114886070317849385623222411358949668787867107396964164411902344657839), (65607797593031777025327213441406429706229554693111301829739246585877159816272, 79961617861579655228245596945584251075927713624783972033702352803989157374968), (64657091722259095378927699179738871359414475057069563256403718769393593007828, 75125014257790379731111933631459112834235472632644883110858140318850149048353), (67084557104402234321232450023342280241607856660775603383379768837339014407390, 69734154273028305998890532806886745289929625091742523754908849263202224536000), (72527740818125541440234020059073841830632266462498974574464321294351611543653, 14540973622498310343507712856035423079156128967363829830147778071925674301940), (70125314938770208579331515834157197892244121111804221382617033982399378618643, 35314745286449230482232618270873133764712528868530927054619541617332826170599), (101644731000380991291432120854818587827264887281269803271497498743440961747884, 40560933322856578201049974567687045305033384372483783534880097284990624671763), (8996568286800109636857858202712574506461894431544158499818981057078671215326, 22201375455663629050200442277672897873177625737955671277905237996336692975921), (65450877535735189342022222555007440300449654745980475538606875299561300691821, 40267534661561095780495394189584482526671516860828335980902780160168729467670), (11116473713828494479197305230758558757578828035790164361208476473167355202175, 63718903650806078444336937006210809826761732262020484923772115674060800468715), (49145832115043358461726016955717613985371155459609558195799205111742460755488, 1793067619661079979849909304787145368474905189258383251779635170735602219865), (73316685558833281492654261514518283024943507193522394002171935212211136830248, 10537223996253890710559944801683423985637248841971411326114316296004672149664), (55792572999445101328672201374390948380564023135095058387668898743967015413278, 1240479601847463638925440464306933593545454738526344032659850430486353058939), (16934979360996370768995706449397141041909540453936076190736881957679458283829, 81865837239586888069496617803026487096628586488015495429404602024430236042089), (92730651308127094507116032150414430927650540487872663503042114783268779939119, 17184657894979265541127793977233190283016293537606513198324369228550653734681), (13232990856283440359955182742637290057573936902985379517858669631167419275331, 104837649424051640414790348064615600297213357581580621906705210013879500351896), (37046962152132186996891082700302552649769448728704737400967285713521531227951, 21239754015181745621416173206649414355581961211825546347571104332035527341619), (87660858566679969234737058905756764197747827324177863375432774946412545906902, 103850948133986494519780459554427073603338421420954724907328743977524820544511), (31415198854463270680322423693279735242972873712523407085509254651710991497543, 43060215085998091916278380455202626103537763477660809936565574859594628698390), (42022967271775691205439065465644658648460711342702486154888062441155630227585, 83561862175007731195174351515692278102710601269253815615380692444141189628021), (37860529899212159998652884517228683944311289720053038110109802551689280493045, 50181626842529127856831546337440213328618585832290503133983546929186787022121), (94114801676952616358036876043909760832457803304975426640958759472244806657288, 55959999100245880648305925215424529938573447650071120003663043034924838308501), (70763202128177259824965446504546453963296825419613689376602585352691405718509, 81733515791282209032413148895308585438249352197315523332149342307162232469022), (2934659003855118185509902559969030972480239509018581360993775581316656199580, 18306275581433298214022407826475392532666315961653841028003019774879075118002), (41237585500637727120328413216579200539916156148700424219878643553104536966463, 84051909168657032997966668384923863106879275764572667049951762092168589090959), (85884258495586835998241890120548189831608908737660873692431633363211242227066, 57386865796636357536015991030803114043314097135460062099603278671929649261655), (33685328889210493855129294484370344683003975481020709233116277775048660368045, 5392192065455668293807743792814169296500348218175455962554063501358896909284), (38967693371701388834139480180945659441638065616834336326272217572271027592148, 18466255826970169031865456403325939767343127090716308568036695590129082298071), (36526180421297665408769598838612627535787501564730589410258206458645814609850, 204480204621889383119524882319640473717749944512237563140617129179636742143), (59301358526943645643086548691992183023296440159437851137356335410282311809979, 27061363357624567119237326321032169633382786240138588860689957879487449120477), (10080388210404371216143109716793423284399321587835950108360346904272476101812, 86582404045108284538281436865779702482634094446602528105139045513495203808272), (55131111770190113746856561037545889512973191788294381083285641141132230250425, 20557023222360543757665891782076951367442204386729054124031506624204814217997), (65953518790396995419818087370540806813275319663537806909308678640400284047165, 13160158158441313929559877528337958630150830521876898532994023724968903934343), (57283927941257026381446572410842250125227488992606432957462460843748034113665, 44664972826533485273128641421419188486590881587566503426475190323624107066583), (114885937447174771752852678045104417085252626226816089253574527774003191088272, 6425626026570557850807163860471650896857216746027031414262793928873106092374), (82404869452263417717381186530816871282556032666935232340503097834546084398946, 30282646557114661258029261299553552293795966653399388325109893863051104397290), (106781214390325780967591326153890130220585085679288472578621506726356404460373, 109987993479731292803973749805781909624080696839914314838190891555746124740173), (49071202177708008602413798874606402734720502755673549225793173489454961323479, 51257576375608310036236653286581069921225063049240432028314056211658317975679), (27225224979478920436893321601668218756458817778338388753713442356883434060414, 75305191093145740057899737336361215846373120799029322821602994953030655869857), (106620762202009680306635153922518152142329850814203654828319505749064924283059, 32296786353358350612143342561454293861648030816261759827210190243015469943840), (8455450363004930516347304889343879293016158047138824498713787075215866724393, 60591710341717212010285724856385573990440909457185288382662180946996890830416), (22455577244686256927499130680930573269555359648998339106480787905124512592936, 41598015298053134358698023633560319780479350563873364311220200549280199061351), (96082104052687141813788713255144631138685891685309280073806340852031265449649, 95764595554798732511456320115883328519419626103863533969038070309583081858850), (105598793573973703486776860846817816575407228595852636026559400303981886908858, 57170369736236293095764605549396550940403986749606445908554564508327657038129), (53157941807870010704228734223547474945631343096353443442347518409122797317000, 56932322814819755524992079367841911432384014900617621327624620656525980487743), (108383962693068477217412913893106207305026636186972882331356530098622710078207, 101917817416990246557020655049013896282843825590744021047905684903096107478732), (87923341481175876134404441846716807848778283520485322012182804567289206169774, 20796525667147734079381921219553206128793109320550952735973430267757258990436), (60578460662250175114609131272642911686447545673284228140456021161055983549883, 25672906893534069545352271374046140897844384404409790907501154907967514801824), (59882219844883880671806736973692248433726123196723501589408358113228913515626, 85120310027981152520288807824505302735114837092787475065823770178824236126663), (26216420809455756891052241973673355526398819923719750539074300232240367508508, 36008235005823506579125039675354696057815875439518714253731390188540295653129), (107686585583621101577414499590163886889301137068247795189489151312597950202408, 71556459589522420094828248479799492577657623312515531752790759056216412650918)]


    s_list =[133599476864255682028560782031246520874000633430055013234832389888843540904692, 83109894435989821908748593767515995588388441138993632814371280419696953132591, 104181992202770593643478119744637612440945271491419745421430132557196936882093, 127384828177016887160379040996205438119188739861299087107015853737708024001109, 84863253308191979949632158312748199647969412982925064799737391824152434593516, 71206910882075911238520156830944942140861926922723343528576698278549211596990, 147716761378189452114447209187143995071806800021492907639101956052259419700730, 169958632815214284950563141107100911992669980151927425486051921952837766591365, 50383960659213307746737209718198843333860129710426079984679561248657143977613, 161941338207206933113429674650381242070582083444849344693426270489850156938719, 187484490290034448769582636551701834531388981932318949650609425688272016713378, 80422478111119557326958472608745687032691338528087448982058276712911093733751, 162131868104906261351581642451087562874509423274952047370178008374211453983205, 149476025582561904146109345092003460146070723475397516269597430157914897930277, 177441294369483560662684051545116509150300396241985928890958419334414830453663, 118556314922106878317673565782738033441523044789959167904788034671842692065535, 121300270894021278859347516553272032547794275572732208158088063087356764651074, 52420450525788392967201191222894055071758486322334070512007617695278749224720, 144389973170454156118768933384564784795115371170031801128085111625941576629739, 132940368579088877691948863385453173298946316772463128652223827837767801485742, 75403508754878345963198011851180935317073395593603664791570741975512701987153, 140065804004662261244126674230983910750281560605155447107308062459629674185170, 204375282756515363318856089320826436922312462431571939734368228182358625074665, 99008141445525939388830049953362472231296101028490469464622810959090315908537, 91942636252559097219352226720543938128919950835022399445968502267017923711521, 132062495993467450953484599194403576392528082991614812888402853667669176319254, 75695858260198682630310743705097374171774782250114508491586216545543643571672, 184083952521090459095143384232051683113940249175770152632423120549353865014855, 31744573983112001457390772185651473596151786153338829760156098557806159646428, 76891441823201262993627771826240578757362275253758035152358802414288458783263, 182834282474990723781150833605745501216477448353002879948595111267480656013159, 154162593632998048539878415408693522894415162826653558872305785853733004256677, 160159874127246370862829872333082998516632564303587161789691640140003518374856, 124800365370917347244392911221706312069290829060388217211811670206996451128302, 226857021672887079162961486077794629858016019723236317911573242862389802696325, 141301938109882375671004011908902693322888708662567561446533030234231341646575, 205885262118653525333387102438697803779600887034115756052139241925421277417283, 123475038101882784601675316184747716043770629975214651238710569927982364280338, 115505083669074903654760291878726563777433352505667966277999209101585846625532, 173537086394455618288839307586899475822796343657919529694038483224374012456747, 165810121621883022765036271787647349087819586995087053926923537559266808663124, 89312873925494525833000449904987032129288265771439792310283363087123875781493, 136315506127837297782150666025002171737015874425437715964305911668574211992793, 118810515097576542294136360296237884897738981300731599272103804825314946335978, 95683766695564337352801003823260648298275105437583413474357091261946044451349, 54715034063452788074259632622798415722479223186629019446804473784117260342473, 128046432235803660781969852459101437222298675849657854633334630353025524923983, 158369777438003996527887745220677999527333745584084242947801801136321045725056, 119912859880432091787509847599148549035925185867461743511063881785454284427229, 82233317746275219945769505061171904094568176564861277527898444056914874472336, 172350015201175121931208465452210683651719565367280785496178227401666915654819, 112814382866612386501888332305554879140529835335325730567510624446934263283135, 137729800208852279992679539017799399178783245148331040092876872717060575595605, 170279488386213021258421903178332208420573167510412446779240624141410795607464, 100659634300824057920788519271777608684394069053905026320564933172890397432576, 74481338012667800994863626882634312318287232467515515362274837939143722684825, 70974804766255385312145415081498673832025470927054665372608216832313820188457, 200367326870117746204915158051550952689437889068890423472355006101732122667737, 90934104917798441101203723783000889962753292138929096240764491247606848661326, 115680971947848193245397308168962413737938950839035637762234951212101809228153, 49814930003551519351650717123692059724209075028779692406265280260266376297197, 136372558445615056626121910455319887981309465488590546993837989026931269756118, 191191228286571119883369477687871120483666304084638148357103006675403028957983, 114342526066393007975017674755012336080522360854730569456779611807141821681081, 144109383516574993251115889914811979233217525445727183331814634307838217676698, 70491375080260969639584741292389268056359489744575664512506511297888063780688, 51699713752326613735928413888356572284523088869220637229313176358673940205854, 205786792277979682871419030864663211939034057432089632621892426237298075845633, 88871334456625072694706943302821259013031343166792443925280787277485030323352, 145885671225616886435009035087617778089340898117116430125154743135345082162393, 197267036171105046202485655698438869764316504318238742677815627659254567531685, 47686719303537898391205581107622285864274649603380207662298527717555615531555, 65546478341604231585054106541799284592595841724807043529928663757544744864269, 126125641276443974828741975732958107897679375612206792733002756112691748760627, 102189447867057959511177715661184187038474939520721109591413927646211810805917, 91206539241592683904879346852978605096857026898019233370405686227538259365996, 137760278569086166898202567629343337236683301623035228894257143749337911098708, 169556378189302744356122444674766266244018090658924341289092988706183474090779, 95856246391907620296397274985466750961299384653550335786433064833823053080575, 200381980475226253519472892423727019491667984592467465055125809289449607733380, 221367287341580439137080660047608478332832990577703416238246911378349509784196, 113296326216835553680901004145117002563321538856128889130912063203484706108587, 85226698908384958910691462322142341153029396268143748986262185643763664424032, 225437441416741890800823905155162733598376833332702144529551897290514803043501, 183839356603734352028200552053238455085522823880898128791090184774079056460649, 202819506056421513670319832732887564285925930451274749316400734775503473670517, 128271949503728357243119305937400223818950845227162740330972537372531763666580, 156369808527443557267394100841533801617069959027448918964839373667937962720695, 121302343038047726407750322227579470001908264484869678922593256827287252874555, 138187947381194298314462544603016568716672287969624364742889786447241954467774, 86951387124690477790116087688557726735471223186693065317192070534286297963178, 79717557784518205423496823094393823701163091028316297725656513158406254386847, 90929616644725900918318757462558809128357886660058821786230297781703395182576, 50080775833280008382187153050398962958684837169932575180768580937909458133400, 61302475481238286395990190841450346918733757736267977842171572475821209477619, 45840202767947256528067398419952638179619457180569306398502279008261327584547, 68574643694972887699878071568753539867874800587266628347117971452360747926089, 102204522927606979165104947634792273395799761720029032408201369974706878243013, 122684451738765923782165928570982570102139689908733722466814946307691670002264, 116734151487203738195911148690259945292523243850611535901663643682734336368002]
    
    X_sum = (64871877686098929847514516878656016616676625321898727191844100448796051700544, 52403126767485441716235446407090602829324623473789543368866081019024878730666)
    
    h = hashlib.sha256() #hash

    m = "hello" #message

    h.update(m.encode())

    c = h.hexdigest()


    """for i in range (0,d):

     #   private_key = random.randint(0,curve.n)

      #  private_key_list.append(private_key)

       # public_key = scalar_mult(private_key,curve.g)

        #public_key_list.append(public_key)

        #r = random.randint(0,curve.n)

        r_list.append(r)

        R = scalar_mult(r,curve.g)

        R_list.append(R)

        s = r + (int(c,16) * private_key) % curve.n

        s_list.append(s)"""

        

    #public_key_sum_list.append(public_key_list[0])

    R_sum_list.append(R_list[0])
    
    """for X in range(0,d-1):

        X_sum = point_add(public_key_sum_list[X], public_key_list[X + 1])

        public_key_sum_list.append(X_sum)

    X_sum = public_key_sum_list.pop()"""

    for R in range(0,d-1):

        R_sum = point_add(R_sum_list[R],R_list[R + 1])

        R_sum_list.append(R_sum)

    R_sum = R_sum_list.pop()    
    
    s_sum = sum(s_list)

    print("signature : ",R_sum,s_sum)

    Q = scalar_mult(s_sum,curve.g)

    P = scalar_mult(int(c,16),X_sum)

    Y = point_add(R_sum,P)

    print (hex(Q[0]),hex(Q[1]))

    print (hex(Y[0]),hex(Y[1]))

    if Q == Y:

        print("signature is valid !")

    else :

        print("signature is invalid !")    

def ecdsa(d):

    private_key_list = list()
    public_key_list = list()
    
    for i in range(0,d):
        private_key = random.randint(0,curve.n)

        

        private_key_list.append(hex(private_key))

        public_key = scalar_mult(private_key,curve.g)

        

        public_key_list.append(hex(public_key[0]))

    return public_key_list,private_key_list        
def signature(message,private_key):
    r = 0

    s = 0

    h = hashlib.sha256()

    m = message

    private_key = int(private_key,16)

    h.update(m.encode())

    c = h.hexdigest()

    while(r == 0 and s == 0):

        k = random.randint(1,(curve.n-1))

        P = scalar_mult(k,curve.g)

        r = P[0] % curve.n

           

        s = ((int(c,16) + (private_key * r)) * inverse_mod(k,curve.n)) % curve.n

        sig = (hex(r) + hex(s)[2:])

        
    return (r,s)

    
    """w = inverse_mod(s,curve.n)

    u1 = (int(c,16) * w ) % curve.n

    u2 = (r * w) % curve.n
    #print(u1)
    
    L = point_add(scalar_mult(u1,curve.g) , scalar_mult(u2,public_key))

    if L[0] % curve.n == r:

        print("signature is valid !")

    else :

        print("signature is invalid !")""" 

def key_r_s_generation(d):


    private_key_list = list()

    public_key_list = list()

    public_key_sum_list = list()

    r_list = list()

    R_list = list()

    R_sum_list = list()

    s_list = list()

    h = hashlib.sha256() #hash

    m = "hello" #message

    h.update(m.encode())

    c = h.hexdigest() 


    for i in range (0,d):



        private_key = random.randint(0,curve.n)

        private_key_list.append(private_key)

        public_key = scalar_mult(private_key,curve.g)


        public_key_list.append(public_key)

        r = random.randint(0,curve.n)

        r_list.append(r)

        R = scalar_mult(r,curve.g)
        
        R_list.append(R)

       

       

        s =( r + (int(c,16) * private_key))

        s_list.append(s)

    public_key_sum_list.append(public_key_list[0])
    R_sum_list.append(R_list[0])
    s_list = sum(s_list) % curve.p

    for X in range(0,d-1):

        X_sum = point_add(public_key_sum_list[X], public_key_list[X + 1])

        public_key_sum_list.append(X_sum)

        R_sum = point_add(R_sum_list[X], R_list[X+1])

        R_sum_list.append(R_sum)

    X_sum = public_key_sum_list.pop()
    R_sum = R_sum_list.pop()

    #return (private_key_list), (public_key_list), (r_list), (s_list), (R_list) ,(c) 
    print("private_key_list: ",private_key_list)
    print("\n")
    print("public_key_list: ",public_key_list)
    print("\n")
    print("r_list: ",r_list)
    print("\n")
    print("s_list: ",s_list)
    print("\n")
    print("R_list: ",R_list)
    print("\n")
    print("c: ",c)
    print("\n")
    print("X_sum: ",X_sum)
    print("\n")
    print("R_sum: ",R_sum)
    
    f = open("C:/Users/handsomelee/Desktop/test_file.txt",'w')
    
    test_file = [str(private_key_list),str(public_key_list),str(r_list),str(s_list),str(R_list),str(c)]
    f.writelines(test_file)
    
    
    f.close()


    #)    
    #print(" %d pair of keys has generated !" %d) 




#multi_schnorr(d=100)
#key_r_s_generation(d=10)
key_pair = ecdsa(d=1)
print(key_pair)
pv_key = key_pair[1][0]
print(signature(message='hello',private_key=pv_key))

    
print('Curve:', curve.name)

# Alice generates her own keypair.
#print("Alice's private key:", hex(alice_private_key))
#print("Alice's public key: (0x{:x}, 0x{:x})".format(*alice_public_key))

# Bob generates his own key pair.
#bob_private_key, bob_public_key = make_keypair()
#print("Bob's private key:", hex(bob_private_key))
#print("Bob's public key: (0x{:x}, 0x{:x})".format(*bob_public_key))

# Alice and Bob exchange their public keys and calculate the shared secret.
#s1 = scalar_mult(alice_private_key, bob_public_key)
#s2 = scalar_mult(bob_private_key, alice_public_key)
#assert s1 == s2

#print('Shared secret: (0x{:x}, 0x{:x})'.format(*s1))